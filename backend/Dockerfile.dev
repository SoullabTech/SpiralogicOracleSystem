# syntax=docker/dockerfile:1.7
FROM node:20-bookworm

WORKDIR /app

# Use OS-level deps for native modules
RUN apt-get update && apt-get install -y --no-install-recommends \
    python3 build-essential git ca-certificates && rm -rf /var/lib/apt/lists/*

# Install dependencies separately for better caching
COPY package.json package-lock.json* ./
RUN npm ci

# App files
COPY . .

# Expose backend port
EXPOSE 8080

# Start with development script
CMD ["npm", "run", "dev"]